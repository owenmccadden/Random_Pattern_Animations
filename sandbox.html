<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Random Pattern</title>
    <link rel="stylesheet" href="./styles.css">
</head>

<body>
    <header>
        <canvas id="mycanvas"></canvas>
    </header>

</body>

<script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script> <!-- processing.js library -->

<script>
    // metadata = require('./metadata.json');
    // alert(JSON.parse(metadata));

    var randomInt = function (a = 0, b) {
        // alert(Math.floor(Math.random() * max - min));
        min = Math.min(a, b);
        max = Math.max(a, b);
        return Math.floor(Math.random() * max - min);
    };

    var generate_metadata = function () {
        meta = {

        }
        meta.x = 500;
        meta.y = 500;

        return meta;
    }

    var sketchProc = function (processingInstance) {
        with(processingInstance) {
            size(1000, 1000);
            frameRate(10);
            background(255, 255, 255);

            // var Walker = function (x, y, speed_x, speed_y, size_x, size_y, r, g, b) {
            //     this.x = x;
            //     this.y = y;
            //     this.speed_x = speed_x;
            //     this.speed_y = speed_y;
            //     this.size_x = size_x;
            //     this.size_y = size_y;
            //     this.r = r;
            //     this.g = g;
            //     this.b = b;
            // };

            var Walker = function (metadata) {
                this.x = metadata.x;
                this.y = metadata.y;
                this.speed_x = metadata.speed_x;
                this.acc_x = metadata.acc_x;
                this.speed_y = metadata.speed_y;
                this.acc_y = metadata.acc_y;
                this.size_x = metadata.size_x;
                this.size_x_inc = metadata.size_x_inc;
                this.size_y = metadata.size_y;
                this.size_y_inc = metadata.size_y_inc;
                this.r_min = metadata.r_min;
                this.r_max = metadata.r_max;
                this.r = metadata.r;
                this.g_min = metadata.g_min;
                this.g_max = metadata.g_max;
                this.g = metadata.g;
                this.b_min = metadata.b_min;
                this.b_max = metadata.b_max;
                this.b = metadata.b;
            };

            Walker.prototype.display = function (shape, strokeQ, rectM) {
                if (strokeQ === 0) {
                    noStroke();
                } else {
                    strokeWeight(1);
                }
                if (rectM === 1) {
                    rectMode(CENTER);
                }

                fill(this.r, this.g, this.b);
                shape(this.x, this.y, this.size_x, this.size_y);
            };

            Walker.prototype.display1 = function (shape, strokeQ, rectM) {
                if (strokeQ === 0) {
                    noStroke();
                } else {
                    strokeWeight(1);
                }
                if (rectM === 1) {
                    rectMode(CENTER);
                }

                fill(this.r, this.g, this.b);
                shape(this.x, this.y, this.size_x, this.size_y);
                shape(this.y, this.x, this.size_x, this.size_y);
                shape(width - this.x, height - this.y, this.size_x, this.size_y);
                shape(width - this.y, height - this.x, this.size_x, this.size_y);
                shape(width - this.x, this.y, this.size_x, this.size_y);
                shape(width - this.y, this.x, this.size_x, this.size_y);
                shape(this.x, height - this.y, this.size_x, this.size_y);
                shape(this.y, height - this.x, this.size_x, this.size_y);
            };

            Walker.prototype.walk = function () {
                var fork = floor(random(0, 4));
                switch (fork) {
                    case 0:
                        this.x += this.speed_x;
                        break;
                    case 1:
                        this.x -= this.speed_x;
                        break;
                    case 2:
                        this.y += this.speed_y;
                        break;
                    case 3:
                        this.y -= this.speed_y;
                        break;
                }

                //confines range in terms of zero, width, and height
                if (this.x < 0) { // minimum x
                    this.x += this.speed_x;
                } else if (this.x > width) { //maximum x
                    this.x -= this.size_x;
                }

                if (this.y < 0) { //minimum y
                    this.y += this.speed_y;
                } else if (this.y > height) { //maximum y
                    this.y -= this.speed_y;
                }
            }

            Walker.prototype.accelerate = function () {
                var fork = floor(random(0, 6));
                switch (fork) {
                    case 0:
                        this.speed_x += this.acc_x;
                        break;
                    case 1:
                        this.speed_x -= this.acc_x;
                        break;
                    case 2:
                        this.speed_y += this.acc_y;
                        break;
                    case 3:
                        this.speed_y -= this.acc_y;
                        break;
                    case 4:
                        this.size_x += this.size_x_inc;
                        break;
                    case 5:
                        this.size_y += this.size_y_inc;
                        break;
                }

                if (this.size_x < randomInt(0, 10)) {
                    this.stretch += this.size_x_inc;
                } else if (this.size_x > randomInt(10, 30)) {
                    this.stretch -= this.size_x_inc;
                }

                if (this.size_y < randomInt(0, 10)) {
                    this.stretch += this.size_y_inc;
                } else if (this.size_y > randomInt(10, 30)) {
                    this.stretch -= this.size_y_inc;
                }

                if (this.speed_x < 2) {
                    this.speed_x += this.acc_x;
                } else if (this.speed_x > 5) {
                    this.speed_x -= this.acc_x;
                }

                if (this.speed_y < 2) {
                    this.speed_y += this.acc_y;
                } else if (this.speed_y > 5) {
                    this.speed_y -= this.acc_y;
                }
            }

            Walker.prototype.colorize = function () {
                this.r = randomInt(this.r_min, this.r_max);
                this.g = randomInt(this.g_min, this.g_max);
                this.b = randomInt(this.b_min, this.b_max);
            }

            metadata = {
                "x": 500,
                "y": 500,
                "speed_x": 25,
                "acc_x": 1,
                "speed_y": 25,
                "acc_y": 1,
                "size_x": 50,
                "size_x_inc": 25,
                "size_y": 50,
                "size_y_inc": 25,
                "r_min": randomInt(0, 255),
                "r_max": randomInt(0, 255),
                "r": 0,
                "g_min": randomInt(0, 255),
                "g_max": randomInt(0, 255),
                "g": 0,
                "b_min": randomInt(0, 255),
                "b_max": randomInt(0, 255),
                "b": 0
            };

            console.log(metadata);

            var w = new Walker(metadata);
            draw = function () {
                w.display1(ellipse, 0, 1);
                w.walk();
                w.accelerate();
                w.colorize();
            }
        }
    };

    var processingInstance = new Processing(document.getElementById("mycanvas"), sketchProc);
</script>

</html>